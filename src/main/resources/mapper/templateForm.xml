<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="templateForm">

    
    <select id="selectTemplateListCount" resultType="int">
		SELECT COUNT(*) AS totalRows
		FROM (
		    SELECT
		        ct.template_code AS templateCode,
		        COUNT(ct.template_code) as templateCount
		    FROM
		        carrier_template ct
		    GROUP BY template_code
		) AS subquery;
	</select>

    <select id="selectTemplateList" resultType="com.suaninc.newsagency.domain.CarrierTemplate">
		SELECT
			ct.template_code AS templateCode,
			COUNT(ct.template_code) as templateCount
		FROM
			carrier_template ct
		group by template_code
		ORDER BY code_id DESC
	    LIMIT #{pageSize} OFFSET #{offset}
    </select>
    
    <select id="selectTemplateInfo" resultType="com.suaninc.newsagency.domain.CarrierTemplate">
		SELECT
			carrier_plan_id AS carrierPlanId,
			template_code AS templateCode,
			carrier_plan_name AS carrierPlanName,
			mobile_carrier AS mobileCarrier,
			monthly_billing_amt AS monthlyBillingAmt,
			basic_amt AS basicAmt,
			discount_amt AS discountAmt,
			voice_call AS voiceCall,
			mobile_data AS mobileData,
			mobile_qos AS mobileQos,
			mobile_message AS mobileMessage,
			registered_datetime AS registeredDatetime
		FROM
			carrier_plan cp
		WHERE	
            carrier_plan_id = #{carrierPlanId}
		ORDER BY carrier_plan_id
    </select>
    
	<update id="updateTemplate" parameterType="com.suaninc.newsagency.domain.CarrierTemplate">
	    UPDATE carrier_plan
	    SET 
	        mobile_carrier = #{mobileCarrier},
	        monthly_billing_amt = #{monthlyBillingAmt},
	        basic_amt = #{basicAmt},
	        discount_amt = #{discountAmt},
	        voice_call = #{voiceCall},
	        mobile_data = #{mobileData},
	        mobile_qos = #{mobileQos},
	        mobile_message = #{mobileMessage}
	    WHERE carrier_plan_id = #{carrierPlanId}
	</update>

</mapper>
